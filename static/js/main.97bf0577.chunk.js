(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{91:function(e,t,a){"use strict";a.r(t);var r,n,s,c=a(1),i=a.n(c),o=a(20),l=a.n(o),d=a(6),u=a(2);!function(e){e.Main="/",e.SignIn="/login",e.Favorites="/favorites",e.Room="/offer",e.NotFound="/404"}(r||(r={})),function(e){e.Offers="/hotels",e.Favorite="/favorite",e.FavoriteStatus="/favorite/hotel_id/:status",e.Login="/login",e.Logout="/logout",e.Reviews="/comments",e.Test="/test"}(n||(n={})),function(e){e.Auth="AUTH",e.NoAuth="NO_AUTH",e.Unknown="UNKNOWN"}(s||(s={}));var j,p,f,b;!function(e){e[e.Cities=0]="Cities",e[e.NearPlaces=1]="NearPlaces",e[e.Favorites=2]="Favorites"}(j||(j={})),function(e){e.Apartment="apartment",e.Room="room",e.House="house",e.Hotel="hotel"}(p||(p={})),function(e){e.Paris="Paris",e.Cologne="Cologne",e.Brussels="Brussels",e.Amsterdam="Amsterdam",e.Hamburg="Hamburg",e.Dusseldorf="Dusseldorf"}(f||(f={})),function(e){e.Popular="Popular",e.PriceIncrease="Price: low to high",e.PriceDecrease="Price: high to low",e.TopRatedFirst="Top rated first"}(b||(b={}));var m,h=a(8),_=a(24),v=a(12),O=a(5);!function(e){e.CityChangedAction="app/city-changed",e.OffersLoadedAction="data/offers-loaded",e.OfferReviewsLoadedAction="data/offers-comments-loaded",e.OfferDetailedLoadedAction="data/detailed-offer-loaded",e.SortTypeChangedAction="sort/sort-type-changed",e.RequireAuthorizationAction="user/require-authorization",e.RequireLogoutAction="user/require-logout",e.LoginChangedAction="user/login-added",e.RedirectedToRouteAction="user/redirect",e.LoadedNearbyOffersAction="data/near-by-places-loaded",e.LoadFavoritesOffersAction="data/load-favorite-offers",e.OfferUpdatedAction="data/offer-updated"}(m||(m={}));var x,g,y=Object(O.b)(m.CityChangedAction,(function(e){return{payload:{activeCity:e}}})),N=Object(O.b)(m.OffersLoadedAction,(function(e){return{payload:{offers:e}}})),w=Object(O.b)(m.SortTypeChangedAction,(function(e){return{payload:{currentSortType:e}}})),k=Object(O.b)(m.RequireAuthorizationAction,(function(e){return{payload:{authStatus:e}}})),S=Object(O.b)(m.RequireLogoutAction),A=Object(O.b)(m.LoginChangedAction,(function(e){return{payload:{login:e}}})),R=Object(O.b)(m.RedirectedToRouteAction,(function(e){return{payload:{url:e}}})),C=Object(O.b)(m.OfferDetailedLoadedAction,(function(e){return{payload:{offer:e}}})),E=Object(O.b)(m.OfferReviewsLoadedAction,(function(e){return{payload:{reviews:e}}})),L=Object(O.b)(m.LoadedNearbyOffersAction,(function(e){return{payload:{nearbyOffers:e}}})),P=Object(O.b)(m.LoadFavoritesOffersAction,(function(e){return{payload:{favoriteOffers:e}}})),F=Object(O.b)(m.OfferUpdatedAction,(function(e){return{payload:{updatedOffer:e}}})),T={authorizationStatus:s.Unknown},M=Object(O.c)(T,(function(e){e.addCase(k,(function(e,t){e.authorizationStatus=t.payload.authStatus})).addCase(S,(function(e){e.authorizationStatus=s.NoAuth}))})),I=a(16),U={offers:[],detailedOffer:null,nearbyOffers:[],isDataLoaded:!1,currentCity:f.Paris,favoriteOffers:[]},D=Object(O.c)(U,(function(e){e.addCase(N,(function(e,t){e.offers=t.payload.offers,e.isDataLoaded=!0})).addCase(C,(function(e,t){e.detailedOffer=t.payload.offer})).addCase(L,(function(e,t){e.nearbyOffers=t.payload.nearbyOffers})).addCase(y,(function(e,t){e.currentCity=t.payload.activeCity})).addCase(P,(function(e,t){e.favoriteOffers=t.payload.favoriteOffers})).addCase(F,(function(e,t){var a;e.offers=z(e.offers,t.payload.updatedOffer),(null===(a=e.detailedOffer)||void 0===a?void 0:a.id)===t.payload.updatedOffer.id&&(e.detailedOffer=t.payload.updatedOffer),e.nearbyOffers=z(e.nearbyOffers,t.payload.updatedOffer),e.favoriteOffers=z(e.favoriteOffers,t.payload.updatedOffer).filter((function(e){return e.isFavorite}))}))})),z=function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return-1===a?e:[].concat(Object(I.a)(e.slice(0,a)),[t],Object(I.a)(e.slice(a+1)))},H=Object(O.c)({email:"",reviews:null},(function(e){e.addCase(A,(function(e,t){e.email=t.payload.login})).addCase(E,(function(e,t){e.reviews=t.payload.reviews}))})),G={currentSortType:b.Popular},Y=Object(O.c)(G,(function(e){e.addCase(w,(function(e,t){e.currentSortType=t.payload.currentSortType}))}));!function(e){e.Offers="OFFERS",e.UserProcesses="USER_PROCESSES",e.UserData="USER_DATA",e.StateData="STATE_DATA"}(g||(g={}));var q,B=Object(v.c)((x={},Object(_.a)(x,g.Offers,D),Object(_.a)(x,g.UserProcesses,M),Object(_.a)(x,g.UserData,H),Object(_.a)(x,g.StateData,Y),x)),V=function(e){return e[g.UserData].email},W=function(e){return e[g.UserData].reviews},Z=a(7),J=a.n(Z),Q=a(15),X="six-sities-token",K=function(e){localStorage.setItem(X,e)},$=function(e){return{city:{name:e.city.name,location:{latitude:e.city.location.latitude,longitude:e.city.location.longitude,zoom:e.city.location.zoom}},previewImage:e.preview_image,images:e.images,title:e.title,isFavorite:e.is_favorite,isPremium:e.is_premium,rating:e.rating,type:e.type,bedrooms:e.bedrooms,maxAdults:e.max_adults,price:e.price,goods:e.goods,host:{id:e.host.id,name:e.host.name,isPro:e.host.is_pro,avatarUrl:e.host.avatar_url},description:e.description,location:{latitude:e.location.latitude,longitude:e.location.longitude,zoom:e.location.zoom},id:String(e.id)}},ee=function(e){return{id:e.id,reviewMessage:e.comment,date:e.date,rating:e.rating,author:{id:e.user.id,avatarUrl:e.user.avatar_url,name:e.user.name,isPro:e.user.is_pro}}},te=function(e){return e.map(ee)},ae=a(18);!function(e){e.REQUIRED_AUTH="\u041d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f",e.LOGIN_SUCCESS="\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u044b. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0432\u0441\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 6 Cities.",e.LOGIN_ERROR="\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443.",e.POST_ERROR_MESSAGE="\u041e\u0442\u0437\u044b\u0432 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443.",e.FAILED_POST_FAVORITE="\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",e.FAILED_GET_FAVORITE="\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."}(q||(q={}));var re=function(e,t){return function(){var a=Object(Q.a)(J.a.mark((function a(r,s,c){var i,o,l;return J.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.post("".concat(n.Favorite,"/").concat(e,"/").concat(t?1:0));case 3:i=a.sent,o=i.data,l=$(o),r(F(l)),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),ae.b.error(q.FAILED_POST_FAVORITE);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e,t,r){return a.apply(this,arguments)}}()},ne=a(0);var se=function(){var e=Object(u.c)(V),t=Object(u.b)();return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("li",{className:"header__nav-item user",children:Object(ne.jsxs)(h.a,{className:"header__nav-link header__nav-link--profile",to:r.Favorites,children:[Object(ne.jsx)("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),Object(ne.jsx)("span",{className:"header__user-name user__name",children:e})]})}),Object(ne.jsx)("li",{className:"header__nav-item",children:Object(ne.jsx)("a",{className:"header__nav-link",href:"#",onClick:function(e){e.preventDefault(),t(R(r.Main)),t(function(){var e=Object(Q.a)(J.a.mark((function e(t,a,r){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.delete(n.Logout);case 2:localStorage.removeItem(X),t(S());case 4:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}())},children:Object(ne.jsx)("span",{className:"header__signout",children:"Sign out"})})})]})};var ce=function(){return Object(ne.jsx)("li",{className:"header__nav-item user",children:Object(ne.jsxs)(h.a,{className:"header__nav-link header__nav-link--profile",to:r.SignIn,children:[Object(ne.jsx)("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),Object(ne.jsx)("span",{className:"header__login",children:"Sign in"})]})})},ie=function(e){return e[g.UserProcesses].authorizationStatus};function oe(){var e=Object(u.c)(ie);return Object(ne.jsx)("header",{className:"header",children:Object(ne.jsx)("div",{className:"container",children:Object(ne.jsxs)("div",{className:"header__wrapper",children:[Object(ne.jsx)("div",{className:"header__left",children:Object(ne.jsx)(h.a,{to:r.Main,className:"header__logo-link header__logo-link--active",children:Object(ne.jsx)("img",{className:"header__logo",src:"img/logo.svg",alt:"6 cities logo",width:"81",height:"41"})})}),Object(ne.jsx)("nav",{className:"header__nav",children:Object(ne.jsx)("ul",{className:"header__nav-list",children:e===s.Auth?Object(ne.jsx)(se,{}):Object(ne.jsx)(ce,{})})})]})})})}var le=Object(c.memo)(oe);var de=function(){var e=Object(u.c)(ie),t=Object(u.b)(),a=Object(d.g)(),i=Object(c.useRef)(null),o=Object(c.useRef)(null),l=function(e){t(function(e){var t=e.login,a=e.password;return function(){var e=Object(Q.a)(J.a.mark((function e(c,i,o){var l,d;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.post(n.Login,{email:t,password:a});case 3:l=e.sent,d=l.data.token,K(d),c(A(t)),c(k(s.Auth)),c(R(r.Main)),ae.b.success(q.LOGIN_SUCCESS),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),ae.b.error(q.LOGIN_ERROR);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,a,r){return e.apply(this,arguments)}}()}(e)),t(A(e.login))};return e===s.Auth&&a.push(r.Main),Object(ne.jsxs)("div",{className:"page page--gray page--login",children:[Object(ne.jsx)(le,{}),Object(ne.jsx)("main",{className:"page__main page__main--login",children:Object(ne.jsxs)("div",{className:"page__login-container container",children:[Object(ne.jsxs)("section",{className:"login",children:[Object(ne.jsx)("h1",{className:"login__title",children:"Sign in"}),Object(ne.jsxs)("form",{className:"login__form form",action:"",method:"post",onSubmit:function(e){e.preventDefault(),null!==i.current&&null!==o.current&&(l({login:i.current.value,password:o.current.value}),a.push(r.Main))},children:[Object(ne.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(ne.jsx)("label",{className:"visually-hidden",children:"E-mail"}),Object(ne.jsx)("input",{ref:i,className:"login__input form__input",type:"email",name:"email",placeholder:"Email",required:!0})]}),Object(ne.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(ne.jsx)("label",{className:"visually-hidden",children:"Password"}),Object(ne.jsx)("input",{ref:o,className:"login__input form__input",type:"password",name:"password",placeholder:"Password",required:!0,pattern:"([A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]*"})]}),Object(ne.jsx)("button",{className:"login__submit form__submit button",type:"submit",children:"Sign in"})]})]}),Object(ne.jsx)("section",{className:"locations locations--login locations--current",children:Object(ne.jsx)("div",{className:"locations__item",children:Object(ne.jsx)(h.a,{className:"locations__item-link",to:r.Main,children:Object(ne.jsx)("span",{children:"Paris"})})})})]})})]})},ue=function(e){return e[g.Offers].detailedOffer},je=function(e){return e[g.Offers].offers.filter((function(t){return t.city.name===be(e)}))},pe=function(e){return e[g.Offers].nearbyOffers},fe=function(e){return e[g.Offers].isDataLoaded},be=function(e){return e[g.Offers].currentCity},me=function(e){return e[g.Offers].favoriteOffers},he=function(e){switch(e){case j.Favorites:return"favorites__card place-card";case j.NearPlaces:return"near-places__card place-card";default:return"cities__place-card place-card"}},_e=function(e){switch(e){case j.Favorites:return"favorites__image-wrapper place-card__image-wrapper";case j.NearPlaces:return"near-places__image-wrapper place-card__image-wrapper";default:return"cities__image-wrapper place-card__image-wrapper"}},ve=function(e){switch(e){case j.Favorites:return"150";case j.NearPlaces:default:return"260"}},Oe=function(e){switch(e){case j.Favorites:return"110";case j.NearPlaces:default:return"200"}},xe=function(e){switch(e){case p.Apartment:return"Apartment";case p.Room:return"Private room";case p.House:return"House";case p.Hotel:return"Hotel";default:throw new Error("Not found offer type: ".concat(e))}};function ge(e){var t=Object(u.b)(),a=Object(d.g)(),n=e.offer,c=n.id,i=n.previewImage,o=n.title,l=n.isPremium,j=n.isFavorite,p=n.type,f=n.price,b=Object(u.c)(ie);return Object(ne.jsxs)("article",{className:he(e.type),onMouseEnter:function(){return e.onMouseEnter&&e.onMouseEnter()},onMouseLeave:function(){return e.onMouseLeave&&e.onMouseLeave()},children:[function(){if(l)return Object(ne.jsx)("div",{className:"place-card__mark",children:Object(ne.jsx)("span",{children:"Premium"})})}(),Object(ne.jsx)("div",{className:_e(e.type),children:Object(ne.jsx)(h.a,{to:"".concat(r.Room,"/").concat(c),children:Object(ne.jsx)("img",{className:"place-card__image",src:i,width:ve(e.type),height:Oe(e.type),alt:"Place image"})})}),Object(ne.jsxs)("div",{className:"place-card__info",children:[Object(ne.jsxs)("div",{className:"place-card__price-wrapper",children:[Object(ne.jsxs)("div",{className:"place-card__price",children:[Object(ne.jsxs)("b",{className:"place-card__price-value",children:["\u20ac",f]}),Object(ne.jsx)("span",{className:"place-card__price-text",children:"/\xa0night"})]}),Object(ne.jsxs)("button",{className:"place-card__bookmark-button ".concat(j&&b===s.Auth?"place-card__bookmark-button--active":""," button"),type:"button",onClick:function(){b===s.Auth?t(re(c,!j)):a.push(r.SignIn)},children:[Object(ne.jsx)("svg",{className:"place-card__bookmark-icon",width:"18",height:"19",children:Object(ne.jsx)("use",{xlinkHref:"#icon-bookmark"})}),Object(ne.jsx)("span",{className:"visually-hidden",children:n.isFavorite?"In bookmarks":"To bookmarks"})]})]}),Object(ne.jsx)("div",{className:"place-card__rating rating",children:Object(ne.jsxs)("div",{className:"place-card__stars rating__stars",children:[Object(ne.jsx)("span",{style:{width:"80%"}}),Object(ne.jsx)("span",{className:"visually-hidden",children:"Rating"})]})}),Object(ne.jsx)("h2",{className:"place-card__name",children:Object(ne.jsx)(h.a,{to:"".concat(r.Room,"/").concat(c),children:o})}),Object(ne.jsx)("p",{className:"place-card__type",children:xe(p)})]})]})}var ye=Object(c.memo)(ge);var Ne=function(e){var t=e.offers,a=e.city;return Object(ne.jsxs)("li",{className:"favorites__locations-items","data-testid":"favorite offers",children:[Object(ne.jsx)("div",{className:"favorites__locations locations locations--current",children:Object(ne.jsx)("div",{className:"locations__item",children:Object(ne.jsx)("a",{className:"locations__item-link",href:"/",children:Object(ne.jsx)("span",{children:a})})})}),Object(ne.jsx)("div",{className:"favorites__places",children:t.filter((function(e){return e.city.name===a})).map((function(e){return Object(ne.jsx)(ye,{type:j.Favorites,offer:e,onMouseEnter:null,onMouseLeave:null},e.id)}))})]})};var we=function(){var e=Object(u.c)(me),t=0!==e.length,a=new Set;e.forEach((function(e){return a.add(e.city.name)}));var r=Object(u.b)();return Object(c.useEffect)((function(){r(function(){var e=Object(Q.a)(J.a.mark((function e(t,a,r){var s,c,i;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.get(n.Favorite);case 3:s=e.sent,c=s.data,i=c.map((function(e){return $(e)})),t(P(i)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ae.b.error(q.FAILED_GET_FAVORITE);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a,r){return e.apply(this,arguments)}}())}),[r]),Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsx)(le,{}),t?Object(ne.jsx)("main",{className:"page__main page__main--favorites",children:Object(ne.jsx)("div",{className:"page__favorites-container container",children:Object(ne.jsxs)("section",{className:"favorites",children:[Object(ne.jsx)("h1",{className:"favorites__title",children:"Saved listing"}),Object(ne.jsx)("ul",{className:"favorites__list",children:Object(I.a)(a).map((function(t){return Object(ne.jsx)(Ne,{city:t,offers:e},t)}))})]})})}):Object(ne.jsx)("main",{className:"page__main page__main--favorites page__main--favorites-empty",children:Object(ne.jsx)("div",{className:"page__favorites-container container",children:Object(ne.jsxs)("section",{className:"favorites favorites--empty",children:[Object(ne.jsx)("h1",{className:"visually-hidden",children:"Favorites (empty)"}),Object(ne.jsxs)("div",{className:"favorites__status-wrapper",children:[Object(ne.jsx)("b",{className:"favorites__status",children:"Nothing yet saved."}),Object(ne.jsx)("p",{className:"favorites__status-description",children:"Save properties to narrow down search or plan your future trips."})]})]})})}),Object(ne.jsx)("footer",{className:"footer container",children:Object(ne.jsx)("a",{className:"footer__logo-link",href:"main.html",children:Object(ne.jsx)("img",{className:"footer__logo",src:"img/logo.svg",alt:"6 cities logo",width:"64",height:"33"})})})]})},ke=a(17),Se=function(e){return e[g.StateData].currentSortType};var Ae=function(){var e=Object(u.b)(),t=Object(u.c)(Se),a=Object(c.useState)(!1),r=Object(ke.a)(a,2),n=r[0],s=r[1],i=Object.values(b),o=function(a){a!==t&&function(t){e(w(t))}(a),s(!1)};return Object(ne.jsxs)("form",{className:"places__sorting",action:"#",method:"get",children:[Object(ne.jsx)("span",{className:"places__sorting-caption",children:"Sort by "}),Object(ne.jsxs)("span",{className:"places__sorting-type",tabIndex:0,onClick:function(){return s(!n)},children:[t,Object(ne.jsx)("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:Object(ne.jsx)("use",{xlinkHref:"#icon-arrow-select"})})]}),Object(ne.jsx)("ul",{className:"places__options places__options--custom ".concat(n?"places__options--opened":"places__options--closed"),children:i.map((function(e){return Object(ne.jsx)("li",{className:"places__option ".concat(e===t?"places__option--active":""),onClick:function(){return o(e)},tabIndex:0,children:e},e)}))})]})};var Re=function(e){var t=function(e,t){switch(e){case b.PriceIncrease:return t.slice().sort((function(e,t){return e.price-t.price}));case b.PriceDecrease:return t.slice().sort((function(e,t){return t.price-e.price}));case b.TopRatedFirst:return t.slice().sort((function(e,t){return t.rating-e.rating}));default:return t}}(Object(u.c)(Se),e.offers);return Object(ne.jsxs)("section",{className:"cities__places places",children:[Object(ne.jsx)("h2",{className:"visually-hidden",children:"Places"}),Object(ne.jsxs)("b",{className:"places__found",children:[e.offers.length," places to stay in ",e.currentCity]}),Object(ne.jsx)(Ae,{}),Object(ne.jsx)("div",{className:"cities__places-list places__list tabs__content",children:t.map((function(t){return Object(ne.jsx)(ye,{type:j.Cities,offer:t,onMouseEnter:function(){return function(t){e.onOfferMouseEnter(t.id)}(t)},onMouseLeave:function(){e.onOfferMouseLeave()}},t.id)}))})]})};var Ce=function(){var e=Object(u.c)(be),t=Object(u.b)();return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("h1",{className:"visually-hidden",children:"Cities"}),Object(ne.jsx)("div",{className:"tabs",children:Object(ne.jsx)("section",{className:"locations container",children:Object(ne.jsx)("ul",{className:"locations__list tabs__list",children:Object.values(f).map((function(a){return Object(ne.jsx)("li",{className:"locations__item",children:Object(ne.jsx)(h.a,{className:"locations__item-link tabs__item ".concat(a===e&&"tabs__item--active"),to:"/",onClick:function(e){e.preventDefault(),t(y(a))},children:Object(ne.jsx)("span",{children:a})})},a)}))})})})]})},Ee=a(19),Le=a.n(Ee);var Pe,Fe=function(e,t){var a=Object(c.useState)(null),r=Object(ke.a)(a,2),n=r[0],s=r[1];return Object(c.useEffect)((function(){if(null!==e.current&&null===n){var a=new Ee.Map(e.current,{center:{lat:t.latitude,lng:t.longitude},zoom:t.zoom}),r=new Ee.TileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'});a.addLayer(r),s(a)}}),[e,n,t]),n},Te=(a(52),new Ee.Icon({iconUrl:"img/pin.svg",iconSize:[27,39],iconAnchor:[20,40]})),Me=new Ee.Icon({iconUrl:"img/pin-active.svg",iconSize:[27,39],iconAnchor:[20,40]});function Ie(e){var t=e.cityLocation,a=e.points,r=e.selectedPoint,n=Object(c.useRef)(null),s=Fe(n,t);return Object(c.useEffect)((function(){s&&(Pe&&Pe.clearLayers(),Pe=Le.a.layerGroup().addTo(s),a.forEach((function(e){new Ee.Marker({lat:e.location.latitude,lng:e.location.longitude}).setIcon(r&&e.id===r.id?Me:Te).addTo(Pe)})))}),[s,a,r]),Object(c.useEffect)((function(){s&&s.setView([t.latitude,t.longitude])}),[s,t]),Object(ne.jsx)("div",{style:{minHeight:"100%",maxWidth:"1144px",marginLeft:"auto",marginRight:"auto"},ref:n})}var Ue=Object(c.memo)(Ie);var De=function(e){var t=e.currentCity;return Object(ne.jsxs)("div",{className:"cities__places-container cities__places-container--empty container",children:[Object(ne.jsx)("section",{className:"cities__no-places",children:Object(ne.jsxs)("div",{className:"cities__status-wrapper tabs__content",children:[Object(ne.jsx)("b",{className:"cities__status",children:"No places to stay available"}),Object(ne.jsxs)("p",{className:"cities__status-description",children:["We could not find any property available at the moment in ",t]})]})}),Object(ne.jsx)("div",{className:"cities__right-section"})]})};var ze=function(){var e=Object(u.c)(je),t=Object(u.c)(be),a=Object(c.useState)(void 0),r=Object(ke.a)(a,2),n=r[0],s=r[1];return Object(ne.jsxs)("div",{className:"page page--gray page--main",children:[Object(ne.jsx)(le,{}),Object(ne.jsxs)("main",{className:0===e.length?"page__main page__main--index page__main--index-empty":"page__main page__main--index",children:[Object(ne.jsx)(Ce,{}),Object(ne.jsx)("div",{className:"cities",children:Object(ne.jsx)("div",{className:"cities__places-container container",children:0===e.length?Object(ne.jsx)(De,{currentCity:t}):Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(Re,{offers:e,currentCity:t,onOfferMouseEnter:function(t){var a=e.find((function(e){return e.id===t}));s(a)},onOfferMouseLeave:function(){s(void 0)}}),Object(ne.jsx)("div",{className:"cities__right-section",children:Object(ne.jsx)("section",{className:"cities__map map",children:Object(ne.jsx)(Ue,{cityLocation:e[0].city.location,points:e.map((function(e){return{id:e.id,location:e.location}})),selectedPoint:n})})})]})})})]})]})};var He=function(){return Object(ne.jsxs)("section",{style:{display:"grid",gridTemplateColumns:"60% 40%",height:"100vh",fontFamily:"rubik, arial, sans-serif",color:"#383838"},children:[Object(ne.jsxs)("div",{style:{maxWidth:"1240px",padding:"0 10px",margin:"0 auto",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center"},children:[Object(ne.jsx)("h1",{style:{fontSize:"48px",fontStyle:"oblique"},children:"It`s just 404 Error!"}),Object(ne.jsx)("p",{style:{display:"block",fontSize:"24px"},children:"The Page you are looking for doesn`t exist or an other error occurred."}),Object(ne.jsxs)("p",{style:{display:"block",fontSize:"24px"},children:[Object(ne.jsx)("a",{href:"/",style:{textDecoration:"underline"},children:"Go back,"}),"to choose a new direction"]})]}),Object(ne.jsx)("div",{style:{background:"url(../img/404_error.jpg)",backgroundPositionX:"35%",backgroundPositionY:"center",borderRadius:"10px",transform:"translateX(10px) rotate(10deg) translateY(5px)",border:"5px solid #4481c3"}})]})};var Ge=function(e){var t=e.offers;return Object(ne.jsxs)("section",{className:"near-places places",children:[Object(ne.jsx)("h2",{className:"near-places__title",children:"Other places in the neighbourhood"}),Object(ne.jsx)("div",{className:"near-places__list places__list",children:t.map((function(e){return Object(ne.jsx)(ye,{type:j.NearPlaces,offer:e,onMouseEnter:null,onMouseLeave:null},e.id)}))})]})},Ye=a(21),qe=a.n(Ye);var Be=function(e){var t=e.review,a=qe()(t.date).format("YYYY-MM-DD"),r=qe()(t.date).format("MMMM YYYY");return Object(ne.jsxs)("li",{className:"reviews__item",children:[Object(ne.jsxs)("div",{className:"reviews__user user",children:[Object(ne.jsx)("div",{className:"reviews__avatar-wrapper user__avatar-wrapper",children:Object(ne.jsx)("img",{className:"reviews__avatar user__avatar",src:t.author.avatarUrl,width:"54",height:"54",alt:"Reviews avatar"})}),Object(ne.jsx)("span",{className:"reviews__user-name",children:t.author.name})]}),Object(ne.jsxs)("div",{className:"reviews__info",children:[Object(ne.jsx)("div",{className:"reviews__rating rating",children:Object(ne.jsxs)("div",{className:"reviews__stars rating__stars",children:[Object(ne.jsx)("span",{style:{width:"80%"}}),Object(ne.jsx)("span",{className:"visually-hidden",children:"Rating"})]})}),Object(ne.jsx)("p",{className:"reviews__text",children:t.reviewMessage}),Object(ne.jsx)("time",{className:"reviews__time",dateTime:a,children:r})]})]})};var Ve=function(e){var t=e.reviews,a=Object(I.a)(t).sort((function(e,t){return qe()(t.date).diff(qe()(e.date))})).slice(0,10);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)("h2",{className:"reviews__title",children:["Reviews \xb7 ",Object(ne.jsx)("span",{className:"reviews__amount",children:a.length})]}),Object(ne.jsx)("ul",{className:"reviews__list",children:a.map((function(e){return Object(ne.jsx)(Be,{review:e},e.id)}))})]})};var We=function(e){var t=e.offerId,a=Object(c.useState)(""),r=Object(ke.a)(a,2),s=r[0],i=r[1],o=Object(c.useState)(0),l=Object(ke.a)(o,2),d=l[0],j=l[1],p=Object(c.useState)(!1),f=Object(ke.a)(p,2),b=f[0],m=f[1],h=Boolean(0===d||s.length<50),_=Object(u.b)(),v=function(e,t){_(function(e,t,a){var r=e.commentText,s=e.rating;return function(){var e=Object(Q.a)(J.a.mark((function e(c,i,o){var l,d;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.onStart(),e.next=4,o.post("".concat(n.Reviews,"/").concat(t),{comment:r,rating:s});case 4:l=e.sent,d=l.data,c(E(te(d))),a.onSuccess(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),a.onError(),ae.b.info(q.POST_ERROR_MESSAGE);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,r){return e.apply(this,arguments)}}()}(e,t,{onStart:function(){m(!0)},onSuccess:function(){i(""),j(0),m(!1)},onError:function(){m(!1)}}))};return Object(ne.jsxs)("form",{className:"reviews__form form",onSubmit:function(e){e.preventDefault(),v({commentText:s,rating:d},t)},children:[Object(ne.jsx)("label",{className:"reviews__label form__label",htmlFor:"review",children:"Your review"}),Object(ne.jsxs)("div",{className:"reviews__rating-form form__rating",children:[Object(ne.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"5",id:"5-stars",type:"radio",onChange:function(){return j(5)},checked:5===d,disabled:b}),Object(ne.jsx)("label",{htmlFor:"5-stars",className:"reviews__rating-label form__rating-label",title:"perfect",children:Object(ne.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(ne.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(ne.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"4",id:"4-stars",type:"radio",onChange:function(){return j(4)},checked:4===d,disabled:b}),Object(ne.jsx)("label",{htmlFor:"4-stars",className:"reviews__rating-label form__rating-label",title:"good",children:Object(ne.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(ne.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(ne.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"3",id:"3-stars",type:"radio",onChange:function(){return j(3)},checked:3===d,disabled:b}),Object(ne.jsx)("label",{htmlFor:"3-stars",className:"reviews__rating-label form__rating-label",title:"not bad",children:Object(ne.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(ne.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(ne.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"2",id:"2-stars",type:"radio",onChange:function(){return j(2)},checked:2===d,disabled:b}),Object(ne.jsx)("label",{htmlFor:"2-stars",className:"reviews__rating-label form__rating-label",title:"badly",children:Object(ne.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(ne.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(ne.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"1",id:"1-star",type:"radio",onChange:function(){return j(1)},checked:1===d,disabled:b}),Object(ne.jsx)("label",{htmlFor:"1-star",className:"reviews__rating-label form__rating-label",title:"terribly",children:Object(ne.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(ne.jsx)("use",{xlinkHref:"#icon-star"})})})]}),Object(ne.jsx)("textarea",{className:"reviews__textarea form__textarea",id:"review",name:"review",placeholder:"Tell how was your stay, what you like and what can be improved",value:s,minLength:50,maxLength:300,disabled:b,onChange:function(e){return i(e.target.value)}}),Object(ne.jsxs)("div",{className:"reviews__button-wrapper",children:[Object(ne.jsxs)("p",{className:"reviews__help",children:["To submit review please make sure to set ",Object(ne.jsx)("span",{className:"reviews__star",children:"rating"})," and describe your stay with at least ",Object(ne.jsxs)("b",{className:"reviews__text-amount",children:[50," characters"]}),"."]}),Object(ne.jsx)("button",{className:"reviews__submit form__submit button",type:"submit",disabled:h||b,children:"Submit"})]})]})};var Ze=function(){var e,t,a,i=Object(u.c)(ue),o=Object(u.c)(W),l=Object(u.c)(ie),j=Object(u.c)(pe),p=[].concat(Object(I.a)(j.slice(0,3).map((function(e){return{id:e.id,location:e.location}}))),Object(I.a)(i?[{id:i.id,location:i.location}]:[])),f=Object(u.b)(),b=Object(d.g)(),m=null===i||void 0===i?void 0:i.isFavorite,h=Object(d.h)().id;return Object(c.useEffect)((function(){var e;f(function(e){return function(){var t=Object(Q.a)(J.a.mark((function t(a,s,c){var i,o,l;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.get("".concat(n.Offers,"/").concat(e));case 3:i=t.sent,o=i.data,l=$(o),a(C(l)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(R(r.NotFound));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(h)),f((e=h,function(){var t=Object(Q.a)(J.a.mark((function t(a,r,s){var c,i;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.get("".concat(n.Reviews,"/").concat(e));case 2:c=t.sent,i=c.data,a(E(te(i)));case 5:case"end":return t.stop()}}),t)})));return function(e,a,r){return t.apply(this,arguments)}}())),f(function(e){return function(){var t=Object(Q.a)(J.a.mark((function t(a,r,s){var c,i,o;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.get("".concat(n.Offers,"/").concat(e,"/nearby"));case 2:c=t.sent,i=c.data,o=i.map((function(e){return $(e)})),a(L(o));case 6:case"end":return t.stop()}}),t)})));return function(e,a,r){return t.apply(this,arguments)}}()}(h)),window.scroll(0,0)}),[h,f]),Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsx)(le,{}),h===(null===i||void 0===i?void 0:i.id)?Object(ne.jsxs)("main",{className:"page__main page__main--property",children:[Object(ne.jsxs)("section",{className:"property",children:[Object(ne.jsx)("div",{className:"property__gallery-container container",children:Object(ne.jsx)("div",{className:"property__gallery",children:null===i||void 0===i?void 0:i.images.slice(0,Math.min(i.images.length,6)).map((function(e){return Object(ne.jsx)("div",{className:"property__image-wrapper",children:Object(ne.jsx)("img",{className:"property__image",src:e,alt:"Photography studio"})},"".concat(e,"-").concat(i.id))}))})}),Object(ne.jsx)("div",{className:"property__container container",children:Object(ne.jsxs)("div",{className:"property__wrapper",children:[(null===i||void 0===i?void 0:i.isPremium)&&Object(ne.jsx)("div",{className:"property__mark",children:Object(ne.jsx)("span",{children:"Premium"})}),Object(ne.jsxs)("div",{className:"property__name-wrapper",children:[Object(ne.jsx)("h1",{className:"property__name",children:null===i||void 0===i?void 0:i.title}),Object(ne.jsxs)("button",{className:(null===i||void 0===i?void 0:i.isFavorite)?"property__bookmark-button property__bookmark-button--active button":"property__bookmark-button button",type:"button",onClick:function(){l===s.Auth?f(re(h,!m)):b.push(r.SignIn)},children:[Object(ne.jsx)("svg",{className:"property__bookmark-icon",width:"31",height:"33",children:Object(ne.jsx)("use",{xlinkHref:"#icon-bookmark"})}),Object(ne.jsx)("span",{className:"visually-hidden",children:(null===i||void 0===i?void 0:i.isFavorite)?"In bookmarks":"To bookmarks"})]})]}),Object(ne.jsxs)("div",{className:"property__rating rating",children:[Object(ne.jsxs)("div",{className:"property__stars rating__stars",children:[Object(ne.jsx)("span",{style:{width:"".concat((a=null===i||void 0===i?void 0:i.rating,Math.round(a)/5*100),"%")}}),Object(ne.jsx)("span",{className:"visually-hidden",children:"Rating"})]}),Object(ne.jsx)("span",{className:"property__rating-value rating__value",children:null===i||void 0===i?void 0:i.rating})]}),Object(ne.jsxs)("ul",{className:"property__features",children:[Object(ne.jsx)("li",{className:"property__feature property__feature--entire",children:xe(null===i||void 0===i?void 0:i.type)}),Object(ne.jsxs)("li",{className:"property__feature property__feature--bedrooms",children:[null===i||void 0===i?void 0:i.bedrooms," Bedrooms"]}),Object(ne.jsxs)("li",{className:"property__feature property__feature--adults",children:["Max ",null===i||void 0===i?void 0:i.maxAdults," adults"]})]}),Object(ne.jsxs)("div",{className:"property__price",children:[Object(ne.jsxs)("b",{className:"property__price-value",children:["\u20ac",null===i||void 0===i?void 0:i.price]}),Object(ne.jsx)("span",{className:"property__price-text",children:"\xa0night"})]}),Object(ne.jsxs)("div",{className:"property__inside",children:[Object(ne.jsx)("h2",{className:"property__inside-title",children:"What's inside"}),Object(ne.jsx)("ul",{className:"property__inside-list",children:null===i||void 0===i?void 0:i.goods.map((function(e){return Object(ne.jsx)("li",{className:"property__inside-item",children:e},"".concat(e,"-").concat(i.title))}))})]}),Object(ne.jsxs)("div",{className:"property__host",children:[Object(ne.jsx)("h2",{className:"property__host-title",children:"Meet the host"}),Object(ne.jsxs)("div",{className:"property__host-user user",children:[Object(ne.jsx)("div",{className:"property__avatar-wrapper property__avatar-wrapper--pro user__avatar-wrapper",children:Object(ne.jsx)("img",{className:"property__avatar user__avatar",src:null===i||void 0===i||null===(e=i.host)||void 0===e?void 0:e.avatarUrl,width:"74",height:"74",alt:"Host avatar"})}),Object(ne.jsx)("span",{className:"property__user-name",children:null===i||void 0===i||null===(t=i.host)||void 0===t?void 0:t.name}),Object(ne.jsx)("span",{className:"property__user-status",children:(null===i||void 0===i?void 0:i.host.isPro)&&Object(ne.jsx)("span",{className:"property__user-status",children:"Pro"})})]}),Object(ne.jsx)("div",{className:"property__description",children:Object(ne.jsx)("p",{className:"property__text",children:null===i||void 0===i?void 0:i.description})})]}),Object(ne.jsxs)("section",{className:"property__reviews reviews",children:[o&&Object(ne.jsx)(Ve,{reviews:o}),l===s.Auth&&(null===i||void 0===i?void 0:i.id)?Object(ne.jsx)(We,{offerId:i.id}):null]})]})}),Object(ne.jsx)("section",{className:"property__map map",children:j&&i?Object(ne.jsx)(Ue,{cityLocation:i.location,points:p,selectedPoint:i}):null})]}),Object(ne.jsx)("div",{className:"container",children:j&&Object(ne.jsx)(Ge,{offers:j})})]}):Object(ne.jsx)("div",{})]})},Je=a(39),Qe=a.n(Je);a(71);var Xe=function(e){var t=e.message;return Object(ne.jsx)("div",{className:"spinner",children:Object(ne.jsxs)("div",{className:"spinner__wrapper",style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(ne.jsx)(Qe.a,{type:"Grid",color:"#4381c3",height:80,width:80}),Object(ne.jsx)("span",{style:{fontSize:"14px",marginLeft:"20px"},children:t})]})})};var Ke=function(e){var t=e.exact,a=e.path,n=e.render,c=Object(u.c)(ie);return Object(ne.jsx)(d.b,{exact:t,path:a,render:function(){return c===s.Auth?n():Object(ne.jsx)(d.a,{to:r.SignIn})}})},$e=a(10),et=Object($e.a)();var tt,at=function(){var e=Object(u.c)(ie),t=Object(u.c)(fe);return function(e){return e===s.Unknown}(e)||!t?Object(ne.jsx)(Xe,{message:"Loading..."}):Object(ne.jsx)(d.c,{history:et,children:Object(ne.jsxs)(d.d,{children:[Object(ne.jsx)(d.b,{exact:!0,path:r.Main,children:Object(ne.jsx)(ze,{})}),Object(ne.jsx)(d.b,{exact:!0,path:r.SignIn,children:Object(ne.jsx)(de,{})}),Object(ne.jsx)(d.b,{exact:!0,path:"".concat(r.Room,"/:id"),children:Object(ne.jsx)(Ze,{})}),Object(ne.jsx)(Ke,{exact:!0,path:r.Favorites,render:function(){return Object(ne.jsx)(we,{})}}),Object(ne.jsx)(d.b,{children:Object(ne.jsx)(He,{})})]})})},rt=a(40),nt=a.n(rt);!function(e){e[e.Unauthorized=401]="Unauthorized"}(tt||(tt={}));var st=function(e){return function(e){return function(t){return t.type===m.RedirectedToRouteAction&&et.push(t.payload.url),e(t)}}},ct=(a(90),function(e){var t=nt.a.create({baseURL:"https://8.react.pages.academy/six-cities",timeout:5e3});return t.interceptors.request.use((function(e){var t=function(){var e=localStorage.getItem(X);return null!==e&&void 0!==e?e:""}();return t&&(e.headers["x-token"]=t),e})),t.interceptors.response.use((function(e){return e}),(function(t){var a=t.response;return(null===a||void 0===a?void 0:a.status)===tt.Unauthorized&&e(),Promise.reject(t)})),t}((function(){return it.dispatch(k(s.NoAuth))}))),it=Object(O.a)({reducer:B,middleware:function(e){return e({thunk:{extraArgument:ct}}).concat(st)}});it.dispatch(function(){var e=Object(Q.a)(J.a.mark((function e(t,a,r){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.get(n.Login).then((function(e){e.data&&(t(A(e.data.email)),t(k(s.Auth)))}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),ae.b.info(q.REQUIRED_AUTH);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a,r){return e.apply(this,arguments)}}()),it.dispatch(function(){var e=Object(Q.a)(J.a.mark((function e(t,a,r){var s,c,i;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.get(n.Offers);case 3:s=e.sent,c=s.data,i=c.map((function(e){return $(e)})),t(N(i)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t(N([]));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a,r){return e.apply(this,arguments)}}()),l.a.render(Object(ne.jsx)(i.a.StrictMode,{children:Object(ne.jsxs)(u.a,{store:it,children:[Object(ne.jsx)(ae.a,{}),Object(ne.jsx)(at,{})]})}),document.getElementById("root"))}},[[91,1,2]]]);
//# sourceMappingURL=main.97bf0577.chunk.js.map